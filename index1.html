<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Captura de Foto</title>
</head>
<body>
    <h1>Captura de Foto</h1>
    <input type="file" accept="image/*" capture="camera" id="cameraInput">
    <button id="uploadButton">Enviar para Google Drive</button>
    
    <script src="https://apis.google.com/js/api.js"></script>
    <script>
        document.getElementById('uploadButton').onclick = function() {
            const fileInput = document.getElementById('cameraInput');
            const file = fileInput.files[0];
            if (!file) {
                alert("Por favor, tire uma foto primeiro.");
                return;
            }
            uploadToDrive(file);
        };

        function uploadToDrive(file) {
            // Autenticação e configuração da API do Google Drive
            gapi.load('client:auth2', function() {
                gapi.auth2.init({
                    client_id: '294110654965-5kf1vog63kktsmhd607i87f3i7tbv113.apps.googleusercontent.com',
                    scope: 'https://www.googleapis.com/auth/drive.file'
                }).then(function () {
                    gapi.auth2.getAuthInstance().signIn().then(function() {
                        const metadata = {
                            'name': file.name,
                            'mimeType': file.type
                        };
                        const form = new FormData();
                        form.append('metadata', new Blob([JSON.stringify(metadata)], { type: 'application/json' }));
                        form.append('file', file);

                        const xhr = new XMLHttpRequest();
                        xhr.open('POST', 'https://www.googleapis.com/upload/drive/v3/files?uploadType=multipart');
                        xhr.setRequestHeader('Authorization', 'Bearer ' + gapi.auth.getToken().access_token);
                        xhr.responseType = 'json';
                        xhr.onload = function() {
                            console.log(xhr.response);
                            alert('Arquivo enviado com sucesso!');
                        };
                        xhr.send(form);
                    });
                });
            });
        }
    </script>
</body>
</html>
